<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Prototipo Arte Terapia</title>
  <style>
    body { font-family: sans-serif; margin:0; padding:0; background:#f5f5f5; }
    .container { max-width: 600px; margin: 2rem auto; background: #fff; padding: 1.5rem; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
    h1,h2 { text-align: center; margin-bottom: 1rem; }
    .hidden { display: none !important; }
    button { background: #6b46c1; color: white; border:none; padding: 0.5rem 1rem; border-radius: 4px; cursor: pointer; }
    button:disabled { background: #ccc; cursor: not-allowed; }
    .card { border: 1px solid #e2e8f0; padding: .75rem; border-radius:4px; margin-bottom: .75rem; }
    .progress-bar { width: 100%; background: #eee; border-radius: 4px; overflow: hidden; margin-bottom: 1rem; }
    .progress-bar-inner { height: 12px; background: #6b46c1; width: 0%; }
    .badge { display:inline-block; background:#d6bcfa; color:#6b46c1; padding:.25rem .5rem; border-radius:4px; margin-top:.5rem; }
    .feedback { margin-top: 1.5rem; }
    .stars { display: flex; gap: 0.5rem; justify-content: center; margin-bottom: 0.5rem; }
    .stars label { cursor: pointer; font-size: 1.5rem; color: #ccc; }
    .stars input:checked ~ label,
    .stars label:hover,
    .stars label:hover ~ label { color: #f5a623; }
    .modal-bg { display: flex; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); align-items: center; justify-content: center; }
    .modal { background:#fff; padding:1.5rem; border-radius:8px; max-width:320px; text-align:center; }
    input[type="file"] { margin-top: .5rem; }
    textarea { width: 100%; height: 80px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; resize: vertical; }
  </style>
</head>
<body>
  <!-- ... Onboarding y Agenda omitidos para brevedad ... -->

  <!-- Quests -->
  <div id="quests" class="container hidden">
    <h2>âœ… Mis Quests</h2>
    <div class="progress-bar"><div id="progInner" class="progress-bar-inner"></div></div>
    <div id="quest-list"></div>

    <!-- SecciÃ³n de Feedback -->
    <div class="feedback">
      <h3>âœ¨ Tu Feedback</h3>
      <div class="stars">
        <input type="radio" id="star5" name="rating" value="5"><label for="star5">â˜…</label>
        <input type="radio" id="star4" name="rating" value="4"><label for="star4">â˜…</label>
        <input type="radio" id="star3" name="rating" value="3"><label for="star3">â˜…</label>
        <input type="radio" id="star2" name="rating" value="2"><label for="star2">â˜…</label>
        <input type="radio" id="star1" name="rating" value="1"><label for="star1">â˜…</label>
      </div>
      <textarea id="feedback-comment" placeholder="Escribe aquÃ­ tus comentariosâ€¦"></textarea>
    </div>

    <div style="text-align:center; margin-top:1rem;">
      <button id="finishQuests" disabled>ðŸŽ‰ Reclamar Recompensa</button>
      <button id="viewDash" style="margin-left:.5rem;">ðŸ“Š Ver Dashboard</button>
    </div>
  </div>

  <!-- ... Dashboard y Modal omitidos ... -->

  <script>
    // CÃ³digo previo de inicializaciÃ³n de sesiones y selecciÃ³n omitido...

    // DespuÃ©s de generar las quests:
    const sessionsArr = ['Arteterapia','Lectura de CafÃ©','Lectura de la Mano'];
    let completed = {}, evidence = {};
    sessionsArr.forEach(s => {
      //... creaciÃ³n dinÃ¡mica de cards (igual que antes) ...
    });

    function updateProgress(){
      const done = Object.values(completed).filter(Boolean).length;
      const pct = done / sessionsArr.length * 100;
      document.getElementById('progInner').style.width = pct+'%';

      // Activar botÃ³n solo si completÃ³ todas las quests
      const btn = document.getElementById('finishQuests');
      btn.disabled = (done < sessionsArr.length);
    }

    // Listener para habilitar botÃ³n de recompensas tambiÃ©n cuando se dÃ© feedback (opcional)
    document.getElementById('finishQuests').onclick = () => {
      // Recoger rating y comentario
      const rating = document.querySelector('input[name="rating"]:checked')?.value || '0';
      const comment = document.getElementById('feedback-comment').value.trim();
      console.log('Feedback enviado:', { rating, comment });
      document.getElementById('modal').classList.remove('hidden');
    };

    document.getElementById('viewDash').onclick = () => show('dashboard');
    function closeModal() {
      document.getElementById('modal').classList.add('hidden');
      show('dashboard');
    }

    // Restablecer lÃ³gica de show(id) y demÃ¡s omitted...
  </script>
</body>
</html>
